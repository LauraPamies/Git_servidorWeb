<!-- ---------------------------------------------------- -->
<!-- ---------------------------------------------------- -->
<!DOCTYPE html>
<html>

<!-- ---------------------------------------------------- -->
<!-- ---------------------------------------------------- -->

<head>
  <meta charset="utf-8" />


  <script src="logicaFake/buscarTodasMediciones.js"></script>
  <script src="logicaFake/buscarMedicionValor.js"></script>

  


  <!-- ---------------------------------------------------- -->

  <script>
    function buscarMedicionValorPulsado() {

      var valor = document.getElementById("valor").value
      var tablafinal = document.getElementById('tabla');

      var tablafilas = tablafinal.getElementsByTagName('tr');


      for (let i = tablafilas.length - 1; i > 0; i--) {
        tablafilas[i].remove();
      }



      // llamo a la función de la lógica (versión fake)
      buscarMedicionValor(valor, function (err, res) {
        // cuando tenga el resultado lo muestro
        if (err) {
          alert(" hubo un error de transmisión http: " + err)
          return
        } else if (res.error) {
          alert(" hubo un error en la llamada: " + JSON.stringify(res.error))
          return
        }


        //--------- METEMOS LOS VALORES EN LA TABLA -----------

        //Aqui vamos a guardar los tr y td con su informacion.
        let tablaContent = ``;

        for (const item of res) {
          //Fijate que utilizamos += para acumular los datos. 
          //Template strings syntax
          tablaContent += `
          <tr>
          <td>${item.id}</td>
          <td>${item.valor}</td>
          <td>${item.fecha}</td>
          <td>${item.latitud}</td>
          <td>${item.longitud}</td>
          </td>
  
          `
        }
        //Finalmente añadimos el contenido a la tabla
        tablafinal.innerHTML += tablaContent
      })

    }
  </script>



  <script>
    function buscarTodasMedicionesPulsado() {

      var tablafinal = document.getElementById('tabla');

      var tablafilas = tablafinal.getElementsByTagName('tr');


      for (let i = tablafilas.length - 1; i > 0; i--) {
        tablafilas[i].remove();
      }


      // llamo a la función de la lógica (versión fake)
      buscarTodasMediciones(function (err, res) {
        // cuando tenga el resultado lo muestro
        if (err) {
          alert(" hubo un error de transmisión http: " + err)
          return
        } else if (res.error) {
          alert(" hubo un error en la llamada: " + JSON.stringify(res.error))
          return
        }

        //--------- METEMOS LOS VALORES EN LA TABLA -----------

        //Aqui vamos a guardar los tr y td con su informacion.
        let tablaContent = ``;

        for (const item of res) {
          //Fijate que utilizamos += para acumular los datos. 
          //Template strings syntax
          tablaContent += `
          <tr>
          <td>${item.id}</td>
          <td>${item.valor}</td>
          <td>${item.fecha}</td>
          <td>${item.latitud}</td>
          <td>${item.longitud}</td>
          </td>
  
          `
        }
        //Finalmente añadimos el contenido a la tabla
        tablafinal.innerHTML += tablaContent
      })

    }
  </script>


</head>

<!-- ---------------------------------------------------- -->
<!-- ---------------------------------------------------- -->

<body>

  <h1>Aplicación web</h1>



  valor:<br>
  <input id="valor" type="text" name="Valor" value="">
  <br>


  <p>

    <button type="buton" onclick="buscarMedicionValorPulsado()">Mostrar medicion por valor</button>

  <p>

  <p>

    <button type="buton" onclick="buscarTodasMedicionesPulsado()">Mostrar todas las mediciones</button>

  <p>




  <table id="tabla">

    <tr>

      <th>Id</th>

      <th>Valor</th>

      <th>Fecha</th>

      <th>Latitud</th>

      <th>Longitud</th>

    </tr>


  </table>






  <p id="salida"></p>

</body>

</html>
<!-- ---------------------------------------------------- -->
<!-- ---------------------------------------------------- -->
<!-- ---------------------------------------------------- -->
<!-- ---------------------------------------------------- -->